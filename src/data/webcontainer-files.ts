import type { FileSystemTree } from '@webcontainer/api';

// Auto-generated by scripts/generate-webcontainer-files.mjs
export const files: FileSystemTree = {
  "index.html": { file: { contents: "<!doctype html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <link rel=\"icon\" type=\"image/svg+xml\" href=\"/vite.svg\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <title>macOS Desktop</title>\n    <style>html,body,#root{height:100%;margin:0}</style>\n  </head>\n  <body>\n    <div id=\"root\"></div>\n    <script type=\"module\" src=\"/src/main.tsx\"></script>\n  </body>\n</html>" } },
  "package-lock.json": { file: { contents: "{\n  \"name\": \"vite-react-app\",\n  \"version\": \"0.0.0\",\n  \"lockfileVersion\": 3,\n  \"requires\": true,\n  \"packages\": {\n    \"\": {\n      \"name\": \"vite-react-app\",\n      \"version\": \"0.0.0\",\n      \"dependencies\": {\n        \"react\": \"^18.2.0\",\n        \"react-dom\": \"^18.2.0\"\n      },\n      \"devDependencies\": {\n        \"@types/react\": \"^18.2.43\",\n        \"@types/react-dom\": \"^18.2.17\",\n        \"@vitejs/plugin-react\": \"^4.2.1\",\n        \"vite\": \"^5.0.8\"\n      }\n    }\n  }\n}" } },
  "package.json": { file: { contents: "{\n  \"name\": \"mac-desktop\",\n  \"private\": true,\n  \"version\": \"0.0.0\",\n  \"type\": \"module\",\n  \"scripts\": {\n    \"dev\": \"vite\",\n    \"build\": \"vite build\",\n    \"preview\": \"vite preview\"\n  },\n  \"dependencies\": {\n    \"react\": \"^18.2.0\",\n    \"react-dom\": \"^18.2.0\"\n  },\n  \"devDependencies\": {\n    \"@types/react\": \"^18.2.43\",\n    \"@types/react-dom\": \"^18.2.17\",\n    \"@vitejs/plugin-react\": \"^4.2.1\",\n    \"vite\": \"^5.0.8\"\n  }\n}" } },
  "public": { directory: {
    "apps": { directory: {
      "registry.json": { file: { contents: "[\n  {\n    \"id\": \"00000000-0000-0000-0000-000000000001\",\n    \"name\": \"Finder\",\n    \"icon\": \"üóÇÔ∏è\",\n    \"path\": \"/src/apps/app-00000000-0000-0000-0000-000000000001/index.tsx\"\n  },\n  {\n    \"id\": \"00000000-0000-0000-0000-000000000002\",\n    \"name\": \"Safari\",\n    \"icon\": \"üåê\",\n    \"path\": \"/src/apps/app-00000000-0000-0000-0000-000000000002/index.tsx\"\n  },\n  {\n    \"id\": \"00000000-0000-0000-0000-000000000003\",\n    \"name\": \"Notes\",\n    \"icon\": \"üìù\",\n    \"path\": \"/src/apps/app-00000000-0000-0000-0000-000000000003/index.tsx\"\n  },\n  {\n    \"id\": \"00000000-0000-0000-0000-000000000004\",\n    \"name\": \"Terminal\",\n    \"icon\": \"üñ•Ô∏è\",\n    \"path\": \"/src/apps/app-00000000-0000-0000-0000-000000000004/index.tsx\"\n  },\n  {\n    \"id\": \"00000000-0000-0000-0000-000000000005\",\n    \"name\": \"Settings\",\n    \"icon\": \"‚öôÔ∏è\",\n    \"path\": \"/src/apps/app-00000000-0000-0000-0000-000000000005/index.tsx\"\n  }\n]\n" } }
    } },
    "vite.svg": { file: { contents: "<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" aria-hidden=\"true\" role=\"img\" class=\"iconify iconify--logos\" width=\"31.88\" height=\"32\" preserveAspectRatio=\"xMidYMid meet\" viewBox=\"0 0 256 257\"><defs><linearGradient id=\"IconifyId1813088fe1fbc01fb466\" x1=\"-.828%\" x2=\"57.636%\" y1=\"7.652%\" y2=\"78.411%\"><stop offset=\"0%\" stop-color=\"#41D1FF\"></stop><stop offset=\"100%\" stop-color=\"#BD34FE\"></stop></linearGradient><linearGradient id=\"IconifyId1813088fe1fbc01fb467\" x1=\"43.376%\" x2=\"50.316%\" y1=\"2.242%\" y2=\"89.03%\"><stop offset=\"0%\" stop-color=\"#FFEA83\"></stop><stop offset=\"8.333%\" stop-color=\"#FFDD35\"></stop><stop offset=\"100%\" stop-color=\"#FFA800\"></stop></linearGradient></defs><path fill=\"url(#IconifyId1813088fe1fbc01fb466)\" d=\"M255.153 37.938L134.897 252.976c-2.483 4.44-8.862 4.466-11.382.048L.875 37.958c-2.746-4.814 1.371-10.646 6.827-9.67l120.385 21.517a6.537 6.537 0 0 0 2.322-.004l117.867-21.483c5.438-.991 9.574 4.796 6.877 9.62Z\"></path><path fill=\"url(#IconifyId1813088fe1fbc01fb467)\" d=\"M185.432.063L96.44 17.501a3.268 3.268 0 0 0-2.634 3.014l-5.474 92.456a3.268 3.268 0 0 0 3.997 3.378l24.777-5.718c2.318-.535 4.413 1.507 3.936 3.838l-7.361 36.047c-.495 2.426 1.782 4.5 4.151 3.78l15.304-4.649c2.372-.72 4.652 1.36 4.15 3.788l-11.698 56.621c-.732 3.542 3.979 5.473 5.943 2.437l1.313-2.028l72.516-144.72c1.215-2.423-.88-5.186-3.54-4.672l-25.505 4.922c-2.396.462-4.435-1.77-3.759-4.114l16.646-57.705c.677-2.35-1.37-4.583-3.769-4.113Z\"></path></svg>" } }
  } },
  "src": { directory: {
    "App.css": { file: { contents: "#root {\n  max-width: 1280px;\n  margin: 0 auto;\n  padding: 2rem;\n  text-align: center;\n}\n\n.logo {\n  height: 6em;\n  padding: 1.5em;\n  will-change: filter;\n  transition: filter 300ms;\n}\n.logo:hover {\n  filter: drop-shadow(0 0 2em #646cffaa);\n}\n.logo.react:hover {\n  filter: drop-shadow(0 0 2em #61dafbaa);\n}\n\n@keyframes logo-spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n@media (prefers-reduced-motion: no-preference) {\n  a:nth-of-type(2) .logo {\n    animation: logo-spin infinite 20s linear;\n  }\n}\n\n.card {\n  padding: 2em;\n}\n\n.read-the-docs {\n  color: #888;\n}" } },
    "apps": { directory: {
      "app-00000000-0000-0000-0000-000000000001": { directory: {
        "index.tsx": { file: { contents: "import React from 'react'\nexport default function Finder(){\n  return (\n    <div>\n      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}>\n        <div style={{fontWeight:600}}>Finder</div>\n        <span className=\"badge\">Home</span>\n      </div>\n      <p className=\"muted\">This is a simple Finder. It lists installed apps:</p>\n      <AppsList />\n    </div>\n  )\n}\n\ntype App = { id: string; name: string; icon: string }\n\nfunction AppsList(){\n  const [apps, setApps] = React.useState<App[]>([])\n  React.useEffect(()=>{ fetch('/apps/registry.json').then(r=>r.json()).then(setApps) },[])\n  return (\n    <ul className=\"list\">\n      {apps.map(a=> <li key={a.id}>{a.icon} {a.name} <code style={{color:'#6b7280'}}>{a.id.slice(0,8)}</code></li>)}\n    </ul>\n  )\n}\n" } }
      } },
      "app-00000000-0000-0000-0000-000000000002": { directory: {
        "index.tsx": { file: { contents: "import React from 'react'\nexport default function Safari(){\n  return (\n    <div>\n      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}>\n        <div style={{fontWeight:600}}>Safari</div>\n        <span className=\"badge\">Preview</span>\n      </div>\n      <p className=\"muted\">Minimal browser placeholder. Open external sites is disabled in this preview.</p>\n      <div style={{background:'#f3f4f6',border:'1px solid #e5e7eb',borderRadius:8,padding:10}}>\n        <div style={{fontSize:13,color:'#6b7280'}}>Address Bar</div>\n        <input style={{width:'100%',padding:8,borderRadius:6,border:'1px solid #d1d5db'}} placeholder=\"https://example.com\" disabled />\n      </div>\n    </div>\n  )\n}\n" } }
      } },
      "app-00000000-0000-0000-0000-000000000003": { directory: {
        "index.tsx": { file: { contents: "import React from 'react'\nexport default function Notes(){\n  const [notes, setNotes] = React.useState([{id:1,text:'Welcome to Notes'}])\n  const [t, setT] = React.useState('')\n  return (\n    <div>\n      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}>\n        <div style={{fontWeight:600}}>Notes</div>\n        <span className=\"badge\">Local</span>\n      </div>\n      <div style={{display:'flex',gap:10,marginTop:10}}>\n        <textarea value={t} onChange={e=>setT(e.target.value)} placeholder=\"Write a note‚Ä¶\" style={{flex:1,height:90,border:'1px solid #e5e7eb',borderRadius:8,padding:8}} />\n        <button onClick={()=>{ if(t.trim()){ setNotes(n=>[{id:Date.now(),text:t.trim()},...n]); setT('') } }} style={{padding:'8px 12px'}}>Add</button>\n      </div>\n      <ul className=\"list\" style={{marginTop:8}}>\n        {notes.map(n=> <li key={n.id}>{n.text}</li>)}\n      </ul>\n    </div>\n  )\n}\n" } }
      } },
      "app-00000000-0000-0000-0000-000000000004": { directory: {
        "index.tsx": { file: { contents: "import React from 'react'\nexport default function Terminal(){\n  const [lines, setLines] = React.useState(['Welcome to Terminal'])\n  const [cmd, setCmd] = React.useState('help')\n  return (\n    <div>\n      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}>\n        <div style={{fontWeight:600}}>Terminal</div>\n        <span className=\"badge\">Demo</span>\n      </div>\n      <div style={{fontFamily:'ui-monospace, SFMono-Regular, Menlo, monospace',background:'#111827',color:'#d1d5db',borderRadius:8,padding:10,marginTop:8}}>\n        {lines.map((l,i)=>(<div key={i}>{'>'} {l}</div>))}\n      </div>\n      <div style={{display:'flex',gap:8,marginTop:8}}>\n        <input value={cmd} onChange={e=>setCmd(e.target.value)} style={{flex:1,border:'1px solid #e5e7eb',borderRadius:6,padding:8}} />\n        <button onClick={()=>{ setLines(l=>[...l, 'executed: '+cmd]); setCmd('') }}>Run</button>\n      </div>\n    </div>\n  )\n}\n" } }
      } },
      "app-00000000-0000-0000-0000-000000000005": { directory: {
        "index.tsx": { file: { contents: "import React from 'react'\nexport default function Settings(){\n  const [dark, setDark] = React.useState(false)\n  return (\n    <div>\n      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}>\n        <div style={{fontWeight:600}}>Settings</div>\n        <span className=\"badge\">System</span>\n      </div>\n      <div style={{marginTop:10}}>\n        <label style={{display:'flex',alignItems:'center',gap:8}}>\n          <input type=\"checkbox\" checked={dark} onChange={()=>setDark(v=>!v)} /> Dark Mode (demo)\n        </label>\n      </div>\n    </div>\n  )\n}\n" } }
      } }
    } },
    "assets": { directory: {
      "react.svg": { file: { contents: "<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" aria-hidden=\"true\" role=\"img\" class=\"iconify iconify--logos\" width=\"35.93\" height=\"32\" preserveAspectRatio=\"xMidYMid meet\" viewBox=\"0 0 256 228\"><path fill=\"#00D8FF\" d=\"M210.483 73.824a171.49 171.49 0 0 0-8.24-2.597c.465-1.9.893-3.777 1.273-5.621c6.238-30.281 2.16-54.676-11.769-62.708c-13.355-7.7-35.196.329-57.254 19.526a171.23 171.23 0 0 0-6.375 5.848a155.866 155.866 0 0 0-4.241-3.917C100.759 3.829 77.587-4.822 63.673 3.233C50.33 10.957 46.379 33.89 51.995 62.588a170.974 170.974 0 0 0 1.892 8.48c-3.28.932-6.445 1.924-9.474 2.98C17.309 83.498 0 98.307 0 113.668c0 15.865 18.582 31.778 46.812 41.427a145.52 145.52 0 0 0 6.921 2.165a167.467 167.467 0 0 0-2.01 9.138c-5.354 28.2-1.173 50.591 12.134 58.266c13.744 7.926 36.812-.22 59.273-19.855a145.567 145.567 0 0 0 5.342-4.923a168.064 168.064 0 0 0 6.92 6.314c21.758 18.722 43.246 26.282 56.54 18.586c13.731-7.949 18.194-32.003 12.4-61.268a145.016 145.016 0 0 0-1.535-6.842c1.62-.48 3.21-.974 4.76-1.488c29.348-9.723 48.443-25.443 48.443-41.52c0-15.417-17.868-30.326-45.517-39.844Zm-6.365 70.984c-1.4.463-2.836.91-4.3 1.345c-3.24-10.257-7.612-21.163-12.963-32.432c5.106-11 9.31-21.767 12.459-31.957c2.619.758 5.16 1.557 7.61 2.4c23.69 8.156 38.14 20.213 38.14 29.504c0 9.896-15.606 22.743-40.946 31.14Zm-10.514 20.834c2.562 12.94 2.927 24.64 1.23 33.787c-1.524 8.219-4.59 13.698-8.382 15.893c-8.067 4.67-25.32-1.4-43.927-17.412a156.726 156.726 0 0 1-6.437-5.87c7.214-7.889 14.423-17.06 21.459-27.246c12.376-1.098 24.068-2.894 34.671-5.345a134.17 134.17 0 0 1 1.386 6.193ZM87.276 214.515c-7.882 2.783-14.16 2.863-17.955.675c-8.075-4.657-11.432-22.636-6.853-46.752a156.923 156.923 0 0 1 1.869-8.499c10.486 2.32 22.093 3.988 34.498 4.994c7.084 9.967 14.501 19.128 21.976 27.15a134.668 134.668 0 0 1-4.877 4.492c-9.933 8.682-19.886 14.842-28.658 17.94ZM50.35 144.747c-12.483-4.267-22.792-9.812-29.858-15.863c-6.35-5.437-9.555-10.836-9.555-15.216c0-9.322 13.897-21.212 37.076-29.293c2.813-.98 5.757-1.905 8.812-2.773c3.204 10.42 7.406 21.315 12.477 32.332c-5.137 11.18-9.399 22.249-12.634 32.792a134.718 134.718 0 0 1-6.318-1.979Zm12.378-84.26c-4.811-24.587-1.616-43.134 6.425-47.789c8.564-4.958 27.502 2.111 47.463 19.835a144.318 144.318 0 0 1 3.841 3.545c-7.438 7.987-14.787 17.08-21.808 26.988c-12.04 1.116-23.565 2.908-34.161 5.309a160.342 160.342 0 0 1-1.76-7.887Zm110.427 27.268a347.8 347.8 0 0 0-7.785-12.803c8.168 1.033 15.994 2.404 23.343 4.08c-2.206 7.072-4.956 14.465-8.193 22.045a381.151 381.151 0 0 0-7.365-13.322Zm-45.032-43.861c5.044 5.465 10.096 11.566 15.065 18.186a322.04 322.04 0 0 0-30.257-.006c4.974-6.559 10.069-12.652 15.192-18.18ZM82.802 87.83a323.167 323.167 0 0 0-7.227 13.238c-3.184-7.553-5.909-14.98-8.134-22.152c7.304-1.634 15.093-2.97 23.209-3.984a321.524 321.524 0 0 0-7.848 12.897Zm8.081 65.352c-8.385-.936-16.291-2.203-23.593-3.793c2.26-7.3 5.045-14.885 8.298-22.6a321.187 321.187 0 0 0 7.257 13.246c2.594 4.48 5.28 8.868 8.038 13.147Zm37.542 31.03c-5.184-5.592-10.354-11.779-15.403-18.433c4.902.192 9.899.29 14.978.29c5.218 0 10.376-.117 15.453-.343c-4.985 6.774-10.018 12.97-15.028 18.486Zm52.198-57.817c3.422 7.8 6.306 15.345 8.596 22.52c-7.422 1.694-15.436 3.058-23.88 4.071a382.417 382.417 0 0 0 7.859-13.026a347.403 347.403 0 0 0 7.425-13.565Zm-16.898 8.101a358.557 358.557 0 0 1-12.281 19.815a329.4 329.4 0 0 1-23.444.823c-7.967 0-15.716-.248-23.178-.732a310.202 310.202 0 0 1-12.513-19.846h.001a307.41 307.41 0 0 1-10.923-20.627a310.278 310.278 0 0 1 10.89-20.637l-.001.001a307.318 307.318 0 0 1 12.413-19.761c7.613-.576 15.42-.876 23.31-.876H128c7.926 0 15.743.303 23.354.883a329.357 329.357 0 0 1 12.335 19.695a358.489 358.489 0 0 1 11.036 20.54a329.472 329.472 0 0 1-11 20.722Zm22.56-122.124c8.572 4.944 11.906 24.881 6.52 51.026c-.344 1.668-.73 3.367-1.15 5.09c-10.622-2.452-22.155-4.275-34.23-5.408c-7.034-10.017-14.323-19.124-21.64-27.008a160.789 160.789 0 0 1 5.888-5.4c18.9-16.447 36.564-22.941 44.612-18.3ZM128 90.808c12.625 0 22.86 10.235 22.86 22.86s-10.235 22.86-22.86 22.86s-22.86-10.235-22.86-22.86s10.235-22.86 22.86-22.86Z\"></path></svg>" } }
    } },
    "desktop": { directory: {
      "Desktop.tsx": { file: { contents: "import React, { useEffect, useRef, useState } from 'react'\n\ninterface App {\n  id: string\n  name: string\n  icon?: string\n  path: string\n  left?: number\n  top?: number\n  width?: number\n  height?: number\n  minimized?: boolean\n  anim?: 'open' | 'close' | 'minimize' | 'restore'\n}\n\ninterface MenuBarProps {\n  appName?: string\n}\n\ninterface WindowProps {\n  app: App\n  zIndex: number\n  onClose: () => void\n  onMinimize: () => void\n  onFocus: () => void\n  onMove: (pos: { left: number; top: number }) => void\n  onResize: (size: { width: number; height: number }) => void\n}\n\nfunction MenuBar({ appName }: MenuBarProps){\n  const [time, setTime] = useState(new Date())\n  useEffect(()=>{ const t=setInterval(()=>setTime(new Date()), 30000); return ()=>clearInterval(t) },[])\n  return (\n    <div className=\"menubar\">\n      <div className=\"title\">Ô£ø {appName || 'Finder'}</div>\n      <div className=\"right\">{time.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}</div>\n    </div>\n  )\n}\n\nfunction Window({ app, zIndex, onClose, onMinimize, onFocus, onMove, onResize }: WindowProps){\n  const [Comp, setComp] = useState<React.ComponentType | null>(null)\n  const draggingRef = useRef<{\n    type: 'move' | 'resize' | null\n    startX: number\n    startY: number\n    startLeft: number\n    startTop: number\n    startWidth: number\n    startHeight: number\n    handle?: 'nw'|'ne'|'sw'|'se'\n    active: boolean\n  }>({ type: null, startX: 0, startY: 0, startLeft: 0, startTop: 0, startWidth: 0, startHeight: 0, active: false })\n\n  useEffect(()=>{\n    let mounted = true\n    import(/* @vite-ignore */ app.path).then(m=>{ if(mounted) setComp(()=>m.default) })\n    return ()=>{ mounted = false }\n  }, [app.path])\n\n  useEffect(()=>{\n    // Allow partial off-screen but keep window reachable\n    const minVisibleX = 64 // keep at least 64px visible horizontally\n    const minVisibleY = 48 // keep at least 48px visible vertically\n    const menubarH = 28\n    const titlebarH = 32\n    function clamp(left: number, top: number, width: number, height: number){\n      const vw = window.innerWidth\n      const vh = window.innerHeight\n      const minLeft = -(width - minVisibleX)\n      const maxLeft = vw - minVisibleX\n      const minTop = menubarH - (titlebarH - 16) // keep ~16px of titlebar visible under menubar\n      const maxTop = vh - minVisibleY\n      return {\n        left: Math.min(Math.max(left, minLeft), maxLeft),\n        top: Math.min(Math.max(top, minTop), maxTop)\n      }\n    }\n    function onMoveDoc(e: MouseEvent){\n      const d = draggingRef.current\n      if (!d.active || !d.type) return\n      if (d.type === 'move'){\n        const dx = e.clientX - d.startX\n        const dy = e.clientY - d.startY\n        const pos = clamp(d.startLeft + dx, d.startTop + dy, d.startWidth, d.startHeight)\n        onMove(pos)\n      } else if (d.type === 'resize'){\n        const dx = e.clientX - d.startX\n        const dy = e.clientY - d.startY\n        let newW = d.startWidth\n        let newH = d.startHeight\n        let newL = d.startLeft\n        let newT = d.startTop\n        const minW = 280\n        const minH = 160\n        switch(d.handle){\n          case 'se':\n            newW = Math.max(minW, d.startWidth + dx)\n            newH = Math.max(minH, d.startHeight + dy)\n            break\n          case 'ne':\n            newW = Math.max(minW, d.startWidth + dx)\n            newH = Math.max(minH, d.startHeight - dy)\n            newT = d.startTop + dy\n            break\n          case 'sw':\n            newW = Math.max(minW, d.startWidth - dx)\n            newH = Math.max(minH, d.startHeight + dy)\n            newL = d.startLeft + dx\n            break\n          case 'nw':\n            newW = Math.max(minW, d.startWidth - dx)\n            newH = Math.max(minH, d.startHeight - dy)\n            newL = d.startLeft + dx\n            newT = d.startTop + dy\n            break\n        }\n        // Relaxed: allow oversize beyond viewport; keep window reachable via clamp on position\n        if (newW < minW) newW = minW\n        if (newH < minH) newH = minH\n        const pos = clamp(newL, newT, newW, newH)\n        onMove(pos)\n        onResize({ width: newW, height: newH })\n      }\n    }\n    function onUp(){ draggingRef.current.active = false; draggingRef.current.type = null }\n    document.addEventListener('mousemove', onMoveDoc)\n    document.addEventListener('mouseup', onUp)\n    return ()=>{\n      document.removeEventListener('mousemove', onMoveDoc)\n      document.removeEventListener('mouseup', onUp)\n    }\n  }, [onMove, onResize])\n\n  function startMove(e: React.MouseEvent){\n    onFocus()\n    draggingRef.current = {\n      type: 'move',\n      startX: e.clientX,\n      startY: e.clientY,\n      startLeft: app.left ?? 90,\n      startTop: app.top ?? 90,\n      startWidth: app.width ?? 560,\n      startHeight: app.height ?? 360,\n      active: true\n    }\n  }\n\n  function startResize(handle: 'nw'|'ne'|'sw'|'se'){\n    return (e: React.MouseEvent)=>{\n      e.stopPropagation()\n      onFocus()\n      draggingRef.current = {\n        type: 'resize',\n        handle,\n        startX: e.clientX,\n        startY: e.clientY,\n        startLeft: app.left ?? 90,\n        startTop: app.top ?? 90,\n        startWidth: app.width ?? 560,\n        startHeight: app.height ?? 360,\n        active: true\n      }\n    }\n  }\n  const classes = ['window']\n  if (app.anim === 'open' || app.anim === 'restore') classes.push('opening')\n  if (app.anim === 'close') classes.push('closing')\n  if (app.anim === 'minimize') classes.push('minimizing')\n  if (app.minimized && !app.anim) classes.push('minimized')\n\n  return (\n    <div className={classes.join(' ')} style={{left: app.left ?? 90, top: app.top ?? 90, width: app.width ?? 560, height: app.height ?? 360, zIndex}} onMouseDown={onFocus}>\n      <div className=\"titlebar\" onMouseDown={startMove}>\n        <div className=\"traffic\" onMouseDown={(e)=>e.stopPropagation()}>\n          <div className=\"b red\" onClick={onClose} title=\"Close\" />\n          <div className=\"b yellow\" onClick={onMinimize} title=\"Minimize\" />\n          <div className=\"b green\" title=\"Zoom\" />\n        </div>\n        <div className=\"title\">{app.name}</div>\n        <div style={{marginLeft:'auto'}} className=\"badge\">{app.id.slice(0,8)}</div>\n      </div>\n      <div className=\"content\">\n        {Comp ? <Comp /> : <div className=\"muted\">Loading {app.name}‚Ä¶</div>}\n      </div>\n      <div className=\"resize-handle nw\" onMouseDown={startResize('nw')} />\n      <div className=\"resize-handle ne\" onMouseDown={startResize('ne')} />\n      <div className=\"resize-handle sw\" onMouseDown={startResize('sw')} />\n      <div className=\"resize-handle se\" onMouseDown={startResize('se')} />\n    </div>\n  )\n}\n\nexport default function Desktop(){\n  const [apps, setApps] = useState<App[]>([])\n  const [open, setOpen] = useState<App[]>([])\n  const [iconPositions, setIconPositions] = useState<Record<string,{left:number;top:number}>>({})\n  const [windowGeometries, setWindowGeometries] = useState<Record<string,{left:number;top:number;width:number;height:number}>>({})\n  const dragIconRef = useRef<{\n    id: string | null\n    startX: number\n    startY: number\n    startLeft: number\n    startTop: number\n    dragging: boolean\n  }>({ id: null, startX: 0, startY: 0, startLeft: 0, startTop: 0, dragging: false })\n  const suppressClickRef = useRef<Set<string>>(new Set())\n  const focusedName = open.length ? open[open.length-1].name : 'Finder'\n\n  useEffect(()=>{\n    fetch('/apps/registry.json?_=' + Date.now())\n      .then(r=>r.json())\n      .then((list: App[])=> {\n        setApps(list)\n        // load icon positions from localStorage if present\n        try{\n          const saved = localStorage.getItem('desktop.iconPositions')\n          if (saved){\n            const parsed = JSON.parse(saved) as Record<string,{left:number;top:number}>\n            setIconPositions(parsed)\n          } else {\n            // initialize default positions in a simple grid\n            const spacingX = 90\n            const spacingY = 90\n            const startX = 16\n            const startY = 52\n            const maxPerCol = 6\n            const pos: Record<string,{left:number;top:number}> = {}\n            list.slice(0, 20).forEach((a, i)=>{\n              const col = Math.floor(i / maxPerCol)\n              const row = i % maxPerCol\n              pos[a.id] = { left: startX + col*spacingX, top: startY + row*spacingY }\n            })\n            setIconPositions(pos)\n          }\n          const savedGeom = localStorage.getItem('desktop.windowGeometries')\n          if (savedGeom){\n            const parsed = JSON.parse(savedGeom) as Record<string,{left:number;top:number;width:number;height:number}>\n            setWindowGeometries(parsed)\n          }\n        } catch {}\n      })\n      .catch(()=> setApps([]))\n  }, [])\n\n  // Dock removed for now.\n\n  function launch(app: App){\n    setOpen(prev => {\n      const idx = prev.findIndex(w => w.id === app.id)\n      if (idx >= 0) {\n        const exists = prev[idx]\n        // If minimized, restore with animation\n        if (exists.minimized){\n          const DURATION = 340\n          // ensure geometry is clamped on restore (relaxed clamp)\n          const minVisibleX = 64, minVisibleY = 48, menubarH = 28, titlebarH = 32\n          const vw = window.innerWidth, vh = window.innerHeight\n          const width = exists.width ?? 600, height = exists.height ?? 380\n          const minLeft = -(width - minVisibleX)\n          const maxLeft = vw - minVisibleX\n          const minTop = menubarH - (titlebarH - 16)\n          const maxTop = vh - minVisibleY\n          const left = Math.min(Math.max(exists.left ?? 90, minLeft), maxLeft)\n          const top = Math.min(Math.max(exists.top ?? 90, minTop), maxTop)\n          const updated = { ...exists, left, top, minimized: false, anim: 'restore' as const }\n          const next = [...prev]\n          next.splice(idx, 1) // bring to front\n          next.push(updated)\n          setTimeout(()=>{\n            setOpen(p=> p.map(w=> w.id===app.id ? { ...w, anim: undefined } : w))\n          }, DURATION)\n          return next\n        }\n        // otherwise just bring to front\n        return [...prev.slice(0, idx), ...prev.slice(idx+1), prev[idx]]\n      }\n      const geom = windowGeometries[app.id]\n      let left = geom?.left ?? app.left ?? 90\n      let top = geom?.top ?? app.top ?? 90\n      const width = geom?.width ?? app.width ?? 600\n      const height = geom?.height ?? app.height ?? 380\n      // clamp initial geometry to viewport (relaxed)\n      const minVisibleX = 64, minVisibleY = 48, menubarH = 28, titlebarH = 32\n      const vw = window.innerWidth, vh = window.innerHeight\n      const minLeft = -(width - minVisibleX)\n      const maxLeft = vw - minVisibleX\n      const minTop = menubarH - (titlebarH - 16)\n      const maxTop = vh - minVisibleY\n      left = Math.min(Math.max(left, minLeft), maxLeft)\n      top = Math.min(Math.max(top, minTop), maxTop)\n      const created: App = { ...app, left, top, width, height, minimized: false, anim: 'open' }\n      const DURATION = 340\n      setTimeout(()=>{\n        setOpen(p=> p.map(w=> w.id===app.id ? { ...w, anim: undefined } : w))\n      }, DURATION)\n      return [...prev, created]\n    })\n  }\n\n  function close(appId: string){\n    // Animate close before removing\n    const DURATION = 220\n    setOpen(prev => prev.map(w => w.id === appId ? { ...w, anim: 'close' } : w))\n    setTimeout(()=>{\n      setOpen(prev => prev.filter(w => w.id !== appId))\n    }, DURATION)\n  }\n\n  function minimize(appId: string){\n    const DURATION = 220\n    setOpen(prev => prev.map(w => w.id === appId ? { ...w, anim: 'minimize' } : w))\n    setTimeout(()=>{\n      setOpen(prev => prev.map(w => w.id === appId ? { ...w, minimized: true, anim: undefined } : w))\n    }, DURATION)\n  }\n\n  function focus(appId: string){\n    setOpen(prev => {\n      const idx = prev.findIndex(w => w.id === appId)\n      if (idx < 0) return prev\n      return [...prev.slice(0, idx), ...prev.slice(idx+1), prev[idx]]\n    })\n  }\n\n  const saveGeometries = (updater: (g: Record<string,{left:number;top:number;width:number;height:number}>)=>Record<string,{left:number;top:number;width:number;height:number}>) => {\n    setWindowGeometries(prev => {\n      const next = updater(prev)\n      try{ localStorage.setItem('desktop.windowGeometries', JSON.stringify(next)) } catch{}\n      return next\n    })\n  }\n\n  function updateWindow(appId: string, partial: Partial<App>){\n    setOpen(prev => prev.map(w => w.id === appId ? { ...w, ...partial } : w))\n    if ('left' in partial || 'top' in partial || 'width' in partial || 'height' in partial){\n      saveGeometries(prev => {\n        const cur = prev[appId] || { left: 90, top: 90, width: 600, height: 380 }\n        return { ...prev, [appId]: { left: partial.left ?? cur.left, top: partial.top ?? cur.top, width: partial.width ?? cur.width, height: partial.height ?? cur.height } }\n      })\n    }\n  }\n\n  useEffect(()=>{\n    function onMoveDoc(e: MouseEvent){\n      const d = dragIconRef.current\n      if (!d.id) return\n      const dx = e.clientX - d.startX\n      const dy = e.clientY - d.startY\n      const threshold = 4\n      if (!d.dragging && Math.hypot(dx, dy) > threshold){\n        d.dragging = true\n        suppressClickRef.current.add(d.id)\n      }\n      if (d.dragging){\n        setIconPositions(prev => ({\n          ...prev,\n          [d.id!]: { left: Math.max(4, d.startLeft + dx), top: Math.max(40, d.startTop + dy) }\n        }))\n      }\n    }\n    function onUp(){\n      const d = dragIconRef.current\n      if (d.id){\n        // persist positions\n        setTimeout(()=>{\n          try{ localStorage.setItem('desktop.iconPositions', JSON.stringify(iconPositionsRef.current)) } catch{}\n        }, 0)\n      }\n      dragIconRef.current = { id: null, startX: 0, startY: 0, startLeft: 0, startTop: 0, dragging: false }\n      // allow clicks again after a tick\n      setTimeout(()=> suppressClickRef.current.clear(), 0)\n    }\n    document.addEventListener('mousemove', onMoveDoc)\n    document.addEventListener('mouseup', onUp)\n    function onResize(){\n      // Re-clamp all windows into viewport on viewport resize (relaxed)\n      const vw = window.innerWidth, vh = window.innerHeight\n      const minVisibleX = 64, minVisibleY = 48, menubarH = 28, titlebarH = 32\n      setOpen(prev => prev.map(w => {\n        const width = w.width ?? 600, height = w.height ?? 380\n        const minLeft = -(width - minVisibleX)\n        const maxLeft = vw - minVisibleX\n        const minTop = menubarH - (titlebarH - 16)\n        const maxTop = vh - minVisibleY\n        let left = Math.min(Math.max(w.left ?? 90, minLeft), maxLeft)\n        let top = Math.min(Math.max(w.top ?? 90, minTop), maxTop)\n        return { ...w, left, top }\n      }))\n    }\n    window.addEventListener('resize', onResize)\n    return ()=>{\n      document.removeEventListener('mousemove', onMoveDoc)\n      document.removeEventListener('mouseup', onUp)\n      window.removeEventListener('resize', onResize)\n    }\n  }, [])\n\n  const iconPositionsRef = useRef(iconPositions)\n  useEffect(()=>{ iconPositionsRef.current = iconPositions }, [iconPositions])\n\n  const [launchingIconId, setLaunchingIconId] = useState<string | null>(null)\n\n  return (\n    <div className=\"desktop\">\n      <div className=\"wallpaper\" />\n      <MenuBar appName={focusedName} />\n\n      <div className=\"desktop-icons\">\n        {apps.slice(0,20).map(a => {\n          const pos = iconPositions[a.id] || { left: 16, top: 52 }\n          return (\n            <div\n              key={a.id}\n              className={`desktop-icon${launchingIconId===a.id ? ' launching' : ''}`}\n              style={{ left: pos.left, top: pos.top }}\n              onMouseDown={(e)=>{\n                dragIconRef.current = {\n                  id: a.id,\n                  startX: e.clientX,\n                  startY: e.clientY,\n                  startLeft: pos.left,\n                  startTop: pos.top,\n                  dragging: false\n                }\n              }}\n              onClick={(e)=>{\n                if (suppressClickRef.current.has(a.id)) { e.preventDefault(); return }\n                setLaunchingIconId(a.id)\n                setTimeout(()=> setLaunchingIconId(prev => prev===a.id ? null : prev), 600)\n                launch(a)\n              }}\n            >\n              <div className=\"glyph\">{a.icon ?? 'üì¶'}</div>\n              <div style={{fontSize:12,marginTop:6}}>{a.name}</div>\n            </div>\n          )\n        })}\n      </div>\n\n      {open.map((app, idx) => (\n        <Window\n          key={app.id}\n          app={app}\n          zIndex={100 + idx}\n          onClose={()=>close(app.id)}\n          onMinimize={()=>minimize(app.id)}\n          onFocus={()=>focus(app.id)}\n          onMove={(pos)=>updateWindow(app.id, pos)}\n          onResize={(size)=>updateWindow(app.id, size)}\n        />\n      ))}\n    </div>\n  )\n}\n" } },
      "styles.css": { file: { contents: "/* Base variables and layout */\n:root{--bar:#f6f6f6;--text:#111;--muted:#6b7280;--bg:#0b1020;--glass:rgba(255,255,255,0.25);--dock:rgba(255,255,255,0.3);}\n*{box-sizing:border-box}\nbody{font-family:Inter,ui-sans-serif,system-ui,Arial}\n.desktop{height:100%;position:relative;color:#111;overflow:hidden}\n.wallpaper{position:absolute;inset:0;background:linear-gradient(135deg,#0b1020 0%,#1e2760 60%,#462e7e 100%)}\n.menubar{position:absolute;left:0;right:0;top:0;height:28px;display:flex;align-items:center;gap:12px;padding:0 12px;background:linear-gradient(to bottom,rgba(255,255,255,.65),rgba(255,255,255,.3));backdrop-filter:saturate(2) blur(10px);border-bottom:1px solid rgba(255,255,255,.35)}\n.menubar .title{font-weight:600;font-size:12px}\n.menubar .right{margin-left:auto;font-size:12px;color:var(--muted)}\n\n/* Dock removed */\n\n/* Desktop icons (absolute + draggable) */\n.desktop-icons{position:absolute;inset:0}\n.desktop-icon{position:absolute;width:64px;text-align:center;color:white;cursor:default;user-select:none;transition:transform .15s ease, filter .2s ease;will-change:transform,filter}\n.desktop-icon:hover{transform:translateY(-6px) scale(1.1);filter:drop-shadow(0 8px 12px rgba(0,0,0,.35))}\n.desktop-icon.launching{animation:icon-bounce .6s cubic-bezier(.28,.84,.42,1)}\n.desktop-icon .glyph{transition:inherit}\n\n@keyframes icon-bounce{\n  0%{transform:translateY(0) scale(1)}\n  30%{transform:translateY(-8px) scale(1.08)}\n  60%{transform:translateY(0) scale(1)}\n  85%{transform:translateY(-4px) scale(1.04)}\n  100%{transform:translateY(0) scale(1)}\n}\n.desktop-icon .glyph{font-size:36px;line-height:36px}\n\n/* Window */\n.window{position:absolute;top:90px;left:90px;min-width:280px;min-height:160px;background:white;border-radius:10px;box-shadow:0 15px 40px rgba(0,0,0,.25);overflow:hidden;border:1px solid rgba(0,0,0,.08);will-change:transform,opacity}\n.window.opening{animation:mac-window-open-spring .34s cubic-bezier(.2,.8,.2,1)}\n.window.closing{animation:mac-window-close .22s cubic-bezier(.2,.8,.2,1) forwards}\n.window.minimizing{animation:mac-window-minimize .22s cubic-bezier(.2,.8,.2,1) forwards}\n.window.minimized{opacity:0;transform:translateY(8px) scale(.92);pointer-events:none;visibility:hidden}\n.window .titlebar{height:32px;display:flex;align-items:center;gap:8px;padding:0 10px;background:linear-gradient(to bottom,rgba(255,255,255,.9),rgba(255,255,255,.65));border-bottom:1px solid rgba(0,0,0,.07);cursor:move}\n.traffic{display:flex;gap:6px;margin-right:6px}\n.traffic .b{width:12px;height:12px;border-radius:50%}\n.b.red{background:#ff5f57}\n.b.yellow{background:#febc2e}\n.b.green{background:#28c840}\n.window .title{font-weight:600;font-size:12px;color:#222}\n.window .content{position:absolute;top:32px;left:0;right:0;bottom:0;padding:12px;font-size:14px;color:#1f2937;overflow:auto}\n\n@keyframes mac-window-open-spring{\n  0%{opacity:0;transform:translateY(10px) scale(.92)}\n  55%{opacity:1;transform:translateY(0) scale(1.04)}\n  100%{opacity:1;transform:translateY(0) scale(1)}\n}\n@keyframes mac-window-close{\n  0%{opacity:1;transform:translateY(0) scale(1)}\n  100%{opacity:0;transform:translateY(6px) scale(.98)}\n}\n@keyframes mac-window-minimize{\n  0%{opacity:1;transform:translateY(0) scale(1)}\n  100%{opacity:0;transform:translateY(12px) scale(.85)}\n}\n\n/* Resize handles (corners) */\n.resize-handle{position:absolute;width:12px;height:12px;background:transparent}\n.resize-handle.nw{left:-1px;top:-1px;cursor:nwse-resize}\n.resize-handle.ne{right:-1px;top:-1px;cursor:nesw-resize}\n.resize-handle.sw{left:-1px;bottom:-1px;cursor:nesw-resize}\n.resize-handle.se{right:-1px;bottom:-1px;cursor:nwse-resize}\n\n/* Misc */\n.badge{font-size:11px;color:#374151;background:#eef2ff;border:1px solid #c7d2fe;border-radius:999px;padding:2px 8px}\n.muted{color:#6b7280}\n.list{padding-left:16px}\n" } }
    } },
    "index.css": { file: { contents: ":root {\n  font-family: Inter, system-ui, Avenir, Helvetica, Arial, sans-serif;\n  line-height: 1.5;\n  font-weight: 400;\n\n  color-scheme: light dark;\n  color: rgba(255, 255, 255, 0.87);\n  background-color: #242424;\n\n  font-synthesis: none;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\na {\n  font-weight: 500;\n  color: #646cff;\n  text-decoration: inherit;\n}\na:hover {\n  color: #535bf2;\n}\n\nbody {\n  margin: 0;\n  display: flex;\n  place-items: center;\n  min-width: 320px;\n  min-height: 100vh;\n}\n\nh1 {\n  font-size: 3.2em;\n  line-height: 1.1;\n}\n\nbutton {\n  border-radius: 8px;\n  border: 1px solid transparent;\n  padding: 0.6em 1.2em;\n  font-size: 1em;\n  font-weight: 500;\n  font-family: inherit;\n  background-color: #1a1a1a;\n  color: inherit;\n  cursor: pointer;\n  transition: border-color 0.25s;\n}\nbutton:hover {\n  border-color: #646cff;\n}\nbutton:focus,\nbutton:focus-visible {\n  outline: 4px auto -webkit-focus-ring-color;\n}\n\n@media (prefers-color-scheme: light) {\n  :root {\n    color: #213547;\n    background-color: #ffffff;\n  }\n  a:hover {\n    color: #747bff;\n  }\n  button {\n    background-color: #f9f9f9;\n  }\n}" } },
    "main.tsx": { file: { contents: "import { StrictMode } from 'react'\nimport { createRoot } from 'react-dom/client'\nimport Desktop from './desktop/Desktop'\nimport './desktop/styles.css'\n\ncreateRoot(document.getElementById('root')!).render(\n  <StrictMode>\n    <Desktop />\n  </StrictMode>\n)\n" } }
  } },
  "vite.config.js": { file: { contents: "import { defineConfig } from 'vite'\nimport react from '@vitejs/plugin-react'\n\nexport default defineConfig({\n  plugins: [react()],\n  server: {\n    host: true,\n    port: 3000\n  }\n})" } }
};
